version: v1alpha1
debug: false
persist: true
machine:
    type: controlplane
    token: vsl8qn.2mx4hyuhdkcj1a9i
    ca:
        crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUJQekNCOHFBREFnRUNBaEVBNU9odnU5ckNoRk5oelN2SWxDRUNmekFGQmdNclpYQXdFREVPTUF3R0ExVUUKQ2hNRmRHRnNiM013SGhjTk1qTXdNVEF6TVRZMU16TTNXaGNOTXpJeE1qTXhNVFkxTXpNM1dqQVFNUTR3REFZRApWUVFLRXdWMFlXeHZjekFxTUFVR0F5dGxjQU1oQUJYMGo2TFlvclJVNWVWQmRWRWoydkh0ck1qRk9kclFoMUZyCnJ5VFUwQU9TbzJFd1h6QU9CZ05WSFE4QkFmOEVCQU1DQW9Rd0hRWURWUjBsQkJZd0ZBWUlLd1lCQlFVSEF3RUcKQ0NzR0FRVUZCd01DTUE4R0ExVWRFd0VCL3dRRk1BTUJBZjh3SFFZRFZSME9CQllFRkJXcU9PeWFXYjhSZ3RjVApRWUtILytaeElkRkVNQVVHQXl0bGNBTkJBQWV5dzl3YnZJM0NzeWVjWFE1Rll2R2swNE44SUpBTGFrQU54aTBhCkdoUWJMNlEwWnlUM2J0cXBrU29vNXlXa292ck0rTk9iRDM4bkZpS0cvMW5iaFE0PQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==
        key: LS0tLS1CRUdJTiBFRDI1NTE5IFBSSVZBVEUgS0VZLS0tLS0KTUM0Q0FRQXdCUVlESzJWd0JDSUVJQ2xXaTh4ZXpzWVdTakZMSkRKb1B4UzhUNFNnTkdtaHo4U21nRHU5eWFCOQotLS0tLUVORCBFRDI1NTE5IFBSSVZBVEUgS0VZLS0tLS0K
    certSANs:
        - kube.cloud.danmanners.com
        - homelab.kube.danmanners.io
    kubelet:
        image: ghcr.io/siderolabs/kubelet:v1.26.0
        extraArgs:
            rotate-server-certificates: true
    network:
        hostname: aws-controlplane-01
        nameservers:
            - 169.254.169.253
        interfaces:
            - interface: eth0
              dhcp: true
            - interface: wg0
              mtu: 1420
              addresses:
                  - 10.5.0.5/24
              routes:
                  - network: 10.4.0.0/23
                    gateway: 10.5.0.1
                  - network: 10.3.0.0/24
                    gateway: 10.5.0.1
              wireguard:
                  privateKey: kMFWN2J9eQSWGrCDDkzXaTajYEjlmYV17TM8n+8kYl0=
                  peers:
                      - publicKey: 5ijD1frMFGgG1O7BigvkFBBEHuqmBaVcq3IxoITb9Go=
                        endpoint: homelab.danmanners.com:51820
                        persistentKeepaliveInterval: 5s
                        allowedIPs:
                            - 10.5.0.0/24
                            - 10.4.0.0/23
                            - 10.3.0.0/24
    install:
        disk: /dev/nvme0n1
        image: ghcr.io/siderolabs/installer:v1.3.2
        bootloader: true
        wipe: false
    features:
        rbac: true
        stableHostname: true
        apidCheckExtKeyUsage: true
cluster:
    id: 3eRRslFXwWz0Wek8kSNFD86Tbsndz3A4_OVvChq1nhs=
    secret: xCv9UkOwUL2KqRlmPDZl7YnGuxWVM70kHi8Lno0MxqY=
    controlPlane:
        endpoint: https://kube.cloud.danmanners.com:6443
    clusterName: aws-talos
    network:
        cni:
            name: none
        dnsDomain: cluster.local
        podSubnets:
            - 10.244.0.0/16
        serviceSubnets:
            - 10.96.0.0/12
    token: eg91a1.76oc4l9j8mgmvndk
    secretboxEncryptionSecret: ABkt7kuHWbq3lKsvW/MFNkUsV86I+No/wZtYxjrxurY=
    ca:
        crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUJpVENDQVMrZ0F3SUJBZ0lRQVlvaUdZdlFEcjl3V3RES0tVKzRCakFLQmdncWhrak9QUVFEQWpBVk1STXcKRVFZRFZRUUtFd3ByZFdKbGNtNWxkR1Z6TUI0WERUSXpNREV3TXpFMk5UTXpOMW9YRFRNeU1USXpNVEUyTlRNegpOMW93RlRFVE1CRUdBMVVFQ2hNS2EzVmlaWEp1WlhSbGN6QlpNQk1HQnlxR1NNNDlBZ0VHQ0NxR1NNNDlBd0VICkEwSUFCR0pHaUppT0doeHplWXJhNzFqeGJ0T213dUhXaFF0alRSaGJSdnBCeFFDNzlKZmNWUDRJOFZpeEUrdlYKUjBpODNrQ1d1YVRqTFNrVzdqY2d2SHh4bzBTallUQmZNQTRHQTFVZER3RUIvd1FFQXdJQ2hEQWRCZ05WSFNVRQpGakFVQmdnckJnRUZCUWNEQVFZSUt3WUJCUVVIQXdJd0R3WURWUjBUQVFIL0JBVXdBd0VCL3pBZEJnTlZIUTRFCkZnUVUxRlJkU2hhU2IyNUl5NDEzUEZPS3BCa1B4bUV3Q2dZSUtvWkl6ajBFQXdJRFNBQXdSUUlnV3FtRG5ER3YKczM1d1UveW0xSDB6RHorOTB2QktpS0c3YXVxZ29EdmtpUndDSVFESWRrZ0daSlFoVGZnQ3J6RjRCSURiT0w5MAprR1ZOVTIrL0Nya0RqczVsU3c9PQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==
        key: LS0tLS1CRUdJTiBFQyBQUklWQVRFIEtFWS0tLS0tCk1IY0NBUUVFSUNSaUswckZyamYzQjBSNzdkckNhQis0K0FKYlcxZHlLL2NpVW5Oa29hK09vQW9HQ0NxR1NNNDkKQXdFSG9VUURRZ0FFWWthSW1JNGFISE41aXRydldQRnUwNmJDNGRhRkMyTk5HRnRHK2tIRkFMdjBsOXhVL2dqeApXTEVUNjlWSFNMemVRSmE1cE9NdEtSYnVOeUM4ZkhHalJBPT0KLS0tLS1FTkQgRUMgUFJJVkFURSBLRVktLS0tLQo=
    aggregatorCA:
        crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUJZRENDQVFhZ0F3SUJBZ0lSQUpKeGs1M2RURjA5Z0JoNDdKZnNOQWt3Q2dZSUtvWkl6ajBFQXdJd0FEQWUKRncweU16QXhNRE14TmpVek16ZGFGdzB6TWpFeU16RXhOalV6TXpkYU1BQXdXVEFUQmdjcWhrak9QUUlCQmdncQpoa2pPUFFNQkJ3TkNBQVFGd0hmRFk2WThjcU5aenRaeUsydldETFZaRFp0ajdvckpqMEJuYWtPbDNHdkZ3cUw1CnFMQmJqNFd0a0dLQ0doREh3UTBCZ0JXejYyQ2szcnlNNUNqQ28yRXdYekFPQmdOVkhROEJBZjhFQkFNQ0FvUXcKSFFZRFZSMGxCQll3RkFZSUt3WUJCUVVIQXdFR0NDc0dBUVVGQndNQ01BOEdBMVVkRXdFQi93UUZNQU1CQWY4dwpIUVlEVlIwT0JCWUVGRFB6WWdvNWsvdm9aM29OeWNmUWR4UFpZWWtCTUFvR0NDcUdTTTQ5QkFNQ0EwZ0FNRVVDCklRREl4UjRZLzdScG9qVHVoMXdpbm01Qm1meTY1K0NoUmMvL1hVYXVBaExaaUFJZ1RRaXJSTGp1Uzg4emVNd0MKUG9DWlVVUGJlZ0RSbER4NEVOdngvWW15ams4PQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==
        key: LS0tLS1CRUdJTiBFQyBQUklWQVRFIEtFWS0tLS0tCk1IY0NBUUVFSUZndFdMazN2Z1JDeUlNUkd4djhHNmJkUE5PcEtVUjRYWjV2L2wxYnJoTWxvQW9HQ0NxR1NNNDkKQXdFSG9VUURRZ0FFQmNCM3cyT21QSEtqV2M3V2NpdHIxZ3kxV1EyYlkrNkt5WTlBWjJwRHBkeHJ4Y0tpK2FpdwpXNCtGclpCaWdob1F4OEVOQVlBVnMrdGdwTjY4ak9Rb3dnPT0KLS0tLS1FTkQgRUMgUFJJVkFURSBLRVktLS0tLQo=
    serviceAccount:
        key: LS0tLS1CRUdJTiBFQyBQUklWQVRFIEtFWS0tLS0tCk1IY0NBUUVFSUg2ZVpibzVWYjR2b3JLSFpYbHgzeG9XRmZhdC9SZ0RZQS9OT3FGUDRUc2RvQW9HQ0NxR1NNNDkKQXdFSG9VUURRZ0FFREh4TnZDSlJHUE1QNEppRzZYNENGNkN2T2RGdkxGeXJkdDJGRVZNUVRZY0pkVFZ5emdLaApHNUxpbHV2dE1VdmNQRXl6OWd5bVdsazBRMGpmR29maXN3PT0KLS0tLS1FTkQgRUMgUFJJVkFURSBLRVktLS0tLQo=
    apiServer:
        image: registry.k8s.io/kube-apiserver:v1.26.0
        certSANs:
            - kube.cloud.danmanners.com
            - homelab.kube.danmanners.io
        disablePodSecurityPolicy: true
        admissionControl:
            - name: PodSecurity
              configuration:
                  apiVersion: pod-security.admission.config.k8s.io/v1alpha1
                  defaults:
                      audit: restricted
                      audit-version: latest
                      enforce: baseline
                      enforce-version: latest
                      warn: restricted
                      warn-version: latest
                  exemptions:
                      namespaces:
                          - kube-system
                      runtimeClasses: []
                      usernames: []
                  kind: PodSecurityConfiguration
        auditPolicy:
            apiVersion: audit.k8s.io/v1
            kind: Policy
            rules:
                - level: Metadata
    controllerManager:
        image: registry.k8s.io/kube-controller-manager:v1.26.0
    proxy:
        image: registry.k8s.io/kube-proxy:v1.26.0
    scheduler:
        image: registry.k8s.io/kube-scheduler:v1.26.0
    discovery:
        enabled: true
    etcd:
        ca:
            crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUJmVENDQVNPZ0F3SUJBZ0lRR2t2SjdlS1NoZFFaMXhZL3VkYTIrREFLQmdncWhrak9QUVFEQWpBUE1RMHcKQ3dZRFZRUUtFd1JsZEdOa01CNFhEVEl6TURFd016RTJOVE16TjFvWERUTXlNVEl6TVRFMk5UTXpOMW93RHpFTgpNQXNHQTFVRUNoTUVaWFJqWkRCWk1CTUdCeXFHU000OUFnRUdDQ3FHU000OUF3RUhBMElBQk1zSUJVZ0RTQWM1CndtcHU4UEt6UmNxS1JlQzZTWjRWazBHWmJFVUNEZFBya3ZNRWlqcWZENnZMVXFwaWoyVXUvV1ZXR1llQ2FSbHIKc2pnZk83VnJLd1NqWVRCZk1BNEdBMVVkRHdFQi93UUVBd0lDaERBZEJnTlZIU1VFRmpBVUJnZ3JCZ0VGQlFjRApBUVlJS3dZQkJRVUhBd0l3RHdZRFZSMFRBUUgvQkFVd0F3RUIvekFkQmdOVkhRNEVGZ1FVejFhV1VRbjJkTStBCjZkcFVtMnZkOExMZDJ1WXdDZ1lJS29aSXpqMEVBd0lEU0FBd1JRSWhBTVN2c0tlNjhYSko0ZUxGb284MXF2T0sKMHF2cHlNYy9WQzlvMit5Szc0QlhBaUErYjFZLy9BR2hRdkhUeFBRRVVydGwzc01pN3dhVHpjOFJKV2VWdW9qdgo2Zz09Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K
            key: LS0tLS1CRUdJTiBFQyBQUklWQVRFIEtFWS0tLS0tCk1IY0NBUUVFSUJMWlhJM2V6ZTYzMVVTbExIUFIyK01RVWRUUVl1aVphc0ozbkVEV3pHdVVvQW9HQ0NxR1NNNDkKQXdFSG9VUURRZ0FFeXdnRlNBTklCem5DYW03dzhyTkZ5b3BGNExwSm5oV1RRWmxzUlFJTjArdVM4d1NLT3A4UApxOHRTcW1LUFpTNzlaVllaaDRKcEdXdXlPQjg3dFdzckJBPT0KLS0tLS1FTkQgRUMgUFJJVkFURSBLRVktLS0tLQo=
